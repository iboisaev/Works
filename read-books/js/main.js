const doc=document;doc.addEventListener("DOMContentLoaded",(function(){const t=doc.getElementsByTagName("body")[0],e=(doc.querySelector(".header"),doc.querySelector(".header__menu"),doc.querySelector(".menu-burger"),doc.querySelector(".btn-up"),doc.querySelector(".more"),doc.querySelectorAll(".mode"),doc.querySelectorAll(".form"),doc.querySelectorAll(".popup")),o=doc.querySelector(".cart-popup"),n=doc.querySelectorAll(".popup__close"),r=doc.querySelector(".items"),c=(doc.querySelectorAll(".filters__btn"),doc.querySelectorAll(".filters__btn.is-checked"),doc.querySelectorAll(".dropdown"),doc.querySelectorAll(".lazy-anchor")),i=doc.querySelectorAll(".lock-padding"),s=doc.querySelectorAll(".lock-margin");let a=!0;function l(){const e=window.innerWidth-doc.querySelector(".wrapper").offsetWidth+"px";if(i.length>0)for(let t=0;t<i.length;t++){i[t].style.paddingRight=e}if(s.length>0)for(let t=0;t<s.length;t++){s[t].style.marginRight=e}t.style.paddingRight=e,t.classList.add("locked"),a=!1,setTimeout((function(){a=!0}),500)}function u(){setTimeout((function(){if(i)for(let t=0;t<i.length;t++){i[t].style.paddingRight="0px"}if(s)for(let t=0;t<s.length;t++){s[t].style.marginRight="0px"}t.style.paddingRight=0,t.classList.remove("locked")}),500),a=!1,setTimeout((function(){a=!0}),500)}function d(t){if(a)return t.classList.remove("open"),u(),t}function p(t){const{id:e,img:o,name:n,author:c,genres:i,originalLang:s,langs:a,classes:l}=t,u=`\n\t\t\t<a href="#" class="${l}" data-img="${o}" data-author="${c}" data-name="${n}" data-genres="${i}" data-original-lang="${s}">\n\t\t\t  \t<span class="item__img ibg" style="background-image: url('${o}');">\n\t\t\t  \t\t<span class="item__cover">\n\t\t\t  \t\t\t<svg class="icon icon--view">\n\t\t\t\t\t\t\t<use xlink:href="img/icons/view.svg#view"></use>\n\t\t\t\t\t\t</svg>\n\t\t\t  \t\t</span>\n\t\t\t  \t</span>\n\t\t\t  \t<span class="item__title">${c} - "${n}"</span>\n\t\t\t</a>\n\t\t`;r.insertAdjacentHTML("beforeend",u)}(async function(t){const e=await fetch(t);if(!e.ok)throw new Error("Ошибка по адресу $(url), статус ошибка $(response.status)!");return await e.json()})("./json/books.json").then((function(t){t.forEach(p)})),setTimeout((function(){const t=doc.querySelectorAll(".item"),e=doc.querySelector(".cart-popup__img"),n=doc.querySelector(".cart-popup__title"),r=doc.querySelector(".cart-popup__name span"),c=doc.querySelector(".cart-popup__genres span"),i=doc.querySelector(".cart-popup__author span"),s=doc.querySelector(".cart-popup__original-lang span");t.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault();const u=this.dataset.img,d=this.dataset.name,p=this.dataset.author,f=this.dataset.genres,g=this.dataset.originalLang;var h;e.setAttribute("src",u),r.innerText=d,n.innerText=d,c.innerText=f,i.innerText=p,s.innerText=g,h=o,a&&(h.classList.add("open"),l())}))})}),1200),n.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault(),d(this.closest(".popup"))}))}),e.forEach(t=>{t.addEventListener("click",(function(e){e.target.closest(".popup__body")||d(t)}))}),doc.addEventListener("keydown",(function(t){27===t.which&&d(doc.querySelector(".popup.open"))})),c.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault();let e=this.getAttribute("href").substring(1);const o=document.getElementById(e).getBoundingClientRect().top-70;window.scrollBy({top:o,behavior:"smooth"})}))})})),$(doc).ready((function(){$("body"),$(".btn-up"),$(".nav__link"),$(".btns"),$(".popup");const t=$(".filters__title");$(".filters__btn"),$(".callback-popup"),$(".thanks-popup"),$(".popup__close");setTimeout((function(){let e=$(".books__right-title span");var o,n,r={},c=$(".items").isotope({itemSelector:".item",percentPosition:!0,layoutMode:"fitRows",fitRows:{gutter:12},sortBy:"number",sortAscending:!0,filter:function(){var t=$(this),e=!n||t.text().match(n),r=!o||t.is(o);return e&&r}}),i=c.data("isotope");t.on("click",(function(){let t=$(this).next();$(this).toggleClass("active"),t.hasClass("open")?t.fadeOut():t.fadeIn(),t.toggleClass("open")})),$(".filters").on("click",".filters__btn",(function(t){var e=$(this),n=e.parents(".button-group").attr("data-filter-group");r[n]=e.attr("data-filter"),o=function(t){var e="";for(var o in t)e+=t[o];return e}(r),c.isotope(),d()}));var s,a,l,u=$(".search-items").keyup((s=function(){n=new RegExp(u.val(),"gi"),c.isotope(),d()},a=a||100,function(){clearTimeout(l);var t=arguments,e=this;function o(){s.apply(e,t)}l=setTimeout(o,a)}));function d(){c.isotope("getItemElements").length;e.text(i.filteredItems.length)}$(".btn-group").each((function(t,e){var o=$(e);o.on("click","button",(function(t){o.find(".is-checked").removeClass("is-checked"),$(t.currentTarget).addClass("is-checked")}))})),d()}),1500)}));