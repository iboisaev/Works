window.addEventListener("load",(function(){const t=doc.querySelector(".preloader");setTimeout((function(){t.classList.add("done")}),1300)}));const doc=document;doc.addEventListener("DOMContentLoaded",(function(){const t=doc.getElementsByTagName("body")[0],e=doc.querySelectorAll(".popup"),n=doc.querySelector(".cart-popup"),o=doc.querySelectorAll(".popup__close"),i=doc.querySelector(".items"),s=doc.querySelectorAll(".lazy-anchor"),r=doc.querySelectorAll(".lock-padding"),c=doc.querySelectorAll(".lock-margin");let a=!0;function l(e){if(a)return e.classList.add("open"),function(){const e=window.innerWidth-doc.querySelector(".wrapper").offsetWidth+"px";if(r.length>0)for(let t=0;t<r.length;t++)r[t].style.paddingRight=e;if(c.length>0)for(let t=0;t<c.length;t++)c[t].style.marginRight=e;t.style.paddingRight=e,t.classList.add("locked"),a=!1,setTimeout((function(){a=!0}),500)}(),e}function u(e){if(a)return e.classList.remove("open"),setTimeout((function(){if(r)for(let t=0;t<r.length;t++)r[t].style.paddingRight="0px";if(c)for(let t=0;t<c.length;t++)c[t].style.marginRight="0px";t.style.paddingRight=0,t.classList.remove("locked")}),500),a=!1,setTimeout((function(){a=!0}),500),e}function d(t){const{img:e,name:n,author:o,genres:s,originalLang:r,classes:c}=t,a=`\n\t\t\t<a href="#" class="${c}" data-img="${e}" data-author="${o}" data-name="${n}" data-genres="${s}" data-original-lang="${r}">\n\t\t\t  \t<span class="item__img ibg" style="background-image: url('${e}');">\n\t\t\t  \t\t<span class="item__cover">\n\t\t\t  \t\t\t<svg class="icon icon--view">\n\t\t\t\t\t\t\t<use xlink:href="img/icons/view.svg#view"></use>\n\t\t\t\t\t\t</svg>\n\t\t\t  \t\t</span>\n\t\t\t  \t</span>\n\t\t\t  \t<span class="item__title">${o} - "${n}"</span>\n\t\t\t</a>\n\t\t`;i.insertAdjacentHTML("beforeend",a)}(async function(t){const e=await fetch(t);if(!e.ok)throw new Error("Ошибка по адресу $(url), статус ошибка $(response.status)!");return await e.json()})("./json/books.json").then((function(t){t.forEach(d)})),setTimeout((function(){const t=doc.querySelectorAll(".item"),e=doc.querySelector(".cart-popup__img"),o=doc.querySelector(".cart-popup__title"),i=doc.querySelector(".cart-popup__name span"),s=doc.querySelector(".cart-popup__genres span"),r=doc.querySelector(".cart-popup__author span"),c=doc.querySelector(".cart-popup__original-lang span");t.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault();const a=this.dataset.img,u=this.dataset.name,d=this.dataset.author,p=this.dataset.genres,f=this.dataset.originalLang;e.setAttribute("src",a),i.innerText=u,o.innerText=u,s.innerText=p,r.innerText=d,c.innerText=f,l(n)}))})}),1200),o.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault(),u(this.closest(".popup"))}))}),e.forEach(t=>{t.addEventListener("click",(function(e){e.target.closest(".popup__body")||u(t)}))}),doc.addEventListener("keydown",(function(t){27===t.which&&u(doc.querySelector(".popup.open"))})),s.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault();let e=this.getAttribute("href").substring(1);const n=document.getElementById(e).getBoundingClientRect().top-70;window.scrollBy({top:n,behavior:"smooth"})}))})})),$(doc).ready((function(){const t=$(".filters__title");setTimeout((function(){let e=$(".books__right-title span");var n,o,i={},s=$(".items").isotope({itemSelector:".item",percentPosition:!0,layoutMode:"fitRows",fitRows:{gutter:12},sortBy:"number",sortAscending:!0,filter:function(){var t=$(this),e=!o||t.text().match(o),i=!n||t.is(n);return e&&i}}),r=s.data("isotope");t.on("click",(function(){let t=$(this).next();$(this).toggleClass("active"),t.hasClass("open")?t.fadeOut():t.fadeIn(),t.toggleClass("open")})),$(".filters").on("click",".filters__btn",(function(t){var e=$(this),o=e.parents(".button-group").attr("data-filter-group");i[o]=e.attr("data-filter"),n=function(t){var e="";for(var n in t)e+=t[n];return e}(i),s.isotope(),d()}));var c,a,l,u=$(".search-items").keyup((c=function(){o=new RegExp(u.val(),"gi"),s.isotope(),d()},a=a||100,function(){clearTimeout(l);var t=arguments,e=this;function n(){c.apply(e,t)}l=setTimeout(n,a)}));function d(){s.isotope("getItemElements").length;e.text(r.filteredItems.length)}$(".btn-group").each((function(t,e){var n=$(e);n.on("click","button",(function(t){n.find(".is-checked").removeClass("is-checked"),$(t.currentTarget).addClass("is-checked")}))})),d()}),1500)}));