const doc=document;doc.addEventListener("DOMContentLoaded",(function(){const t=doc.getElementsByTagName("body")[0],e=(doc.querySelector(".header"),doc.querySelector(".header__menu"),doc.querySelector(".menu-burger"),doc.querySelector(".btn-up"),doc.querySelector(".more"),doc.querySelectorAll(".mode"),doc.querySelectorAll(".form"),doc.querySelectorAll(".popup")),o=doc.querySelector(".cart-popup"),n=doc.querySelectorAll(".popup__close"),c=doc.querySelector(".items"),i=(doc.querySelectorAll(".filters__btn"),doc.querySelectorAll(".filters__btn.is-checked"),doc.querySelectorAll(".dropdown"),doc.querySelectorAll(".lazy-anchor")),r=doc.querySelectorAll(".lock-padding"),s=doc.querySelectorAll(".lock-margin");let l=!0;function a(){const e=window.innerWidth-doc.querySelector(".wrapper").offsetWidth+"px";if(r.length>0)for(let t=0;t<r.length;t++){r[t].style.paddingRight=e}if(s.length>0)for(let t=0;t<s.length;t++){s[t].style.marginRight=e}t.style.paddingRight=e,t.classList.add("locked"),l=!1,setTimeout((function(){l=!0}),500)}function u(){setTimeout((function(){if(r)for(let t=0;t<r.length;t++){r[t].style.paddingRight="0px"}if(s)for(let t=0;t<s.length;t++){s[t].style.marginRight="0px"}t.style.paddingRight=0,t.classList.remove("locked")}),500),l=!1,setTimeout((function(){l=!0}),500)}function d(t){if(l)return t.classList.remove("open"),u(),t}function p(t){const{id:e,img:o,name:n,author:i,genres:r,originalLang:s,langs:l,classes:a}=t,u=`\n\t\t\t<a href="#" class="${a}">\n\t\t\t  \t<span class="item__img ibg" style="background-image: url('${o}');">\n\t\t\t  \t\t<span class="item__cover">\n\t\t\t  \t\t\t<svg class="icon icon--view">\n\t\t\t\t\t\t\t<use xlink:href="img/icons/view.svg#view"></use>\n\t\t\t\t\t\t</svg>\n\t\t\t  \t\t</span>\n\t\t\t  \t</span>\n\t\t\t  \t<span class="item__title">${i} - "${n}"</span>\n\t\t\t</a>\n\t\t`;c.insertAdjacentHTML("beforeend",u)}(async function(t){const e=await fetch(t);if(!e.ok)throw new Error("Ошибка по адресу $(url), статус ошибка $(response.status)!");return await e.json()})("./json/books.json").then((function(t){t.forEach(p)})),setTimeout((function(){doc.querySelectorAll(".item").forEach(t=>{t.addEventListener("click",(function(t){var e;t.preventDefault(),e=o,l&&(e.classList.add("open"),a())}))})}),1200),n.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault(),d(this.closest(".popup"))}))}),e.forEach(t=>{t.addEventListener("click",(function(e){e.target.closest(".popup__body")||d(t)}))}),doc.addEventListener("keydown",(function(t){27===t.which&&d(doc.querySelector(".popup.open"))})),i.forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault();let e=this.getAttribute("href").substring(1);const o=document.getElementById(e).getBoundingClientRect().top-70;window.scrollBy({top:o,behavior:"smooth"})}))})})),$(doc).ready((function(){$("body"),$(".btn-up"),$(".nav__link"),$(".btns"),$(".popup");const t=$(".filters__title");$(".filters__btn"),$(".callback-popup"),$(".thanks-popup"),$(".popup__close");setTimeout((function(){let e=$(".books__right-title span");var o,n,c={},i=$(".items").isotope({itemSelector:".item",percentPosition:!0,layoutMode:"fitRows",fitRows:{gutter:12},sortBy:"number",sortAscending:!0,filter:function(){var t=$(this),e=!n||t.text().match(n),c=!o||t.is(o);return e&&c}}),r=i.data("isotope");t.on("click",(function(){let t=$(this).next();$(this).toggleClass("active"),t.hasClass("open")?t.fadeOut():t.fadeIn(),t.toggleClass("open")})),$(".filters").on("click",".filters__btn",(function(t){var e=$(this),n=e.parents(".button-group").attr("data-filter-group");c[n]=e.attr("data-filter"),o=function(t){var e="";for(var o in t)e+=t[o];return e}(c),i.isotope(),d()}));var s,l,a,u=$(".search-items").keyup((s=function(){n=new RegExp(u.val(),"gi"),i.isotope(),d()},l=l||100,function(){clearTimeout(a);var t=arguments,e=this;function o(){s.apply(e,t)}a=setTimeout(o,l)}));function d(){i.isotope("getItemElements").length;e.text(r.filteredItems.length)}$(".btn-group").each((function(t,e){var o=$(e);o.on("click","button",(function(t){o.find(".is-checked").removeClass("is-checked"),$(t.currentTarget).addClass("is-checked")}))})),d()}),1500)}));